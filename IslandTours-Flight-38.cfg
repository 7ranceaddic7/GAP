//IslandTours-Flight-38 - KSC Island Tours: Seaplane Tour: Flight 38 - Tourists: (4-8)

CONTRACT_TYPE
{


//REQUIREMENTS FOR CONTRACT TO APPEAR

	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = IslandTours-Flight-1
		minCount = 1

	}
	
//	REQUIREMENT
//	{
//		name = CompleteContract
//		type = CompleteContract
//		contractType = SSI-Seaplane
//		minCount = 1
//
//	}


//DATA NODES TO PROCESS FOR CONTRACT USE

	DATA
	{
		type = int
		
		numPassengers = Random(2,4)
	
	}
	
	DATA
	{
		type = List<Kerbal>
		kerbals = [ NewKerbal(), NewKerbal(), NewKerbal(), NewKerbal() ].Random(@numPassengers)
		
	}
	

//CONTRACT DESCRIPTION

	name = IslandTours-Flight-38
	title = Seaplane Tour: Flight 38 - Tourists: @/numPassengers
	group = KSC Island Tours
	agent = KSC Island Tours

	description = KSC Island Tours is impressed with your ability to wow the tourists to KSC and are asking if you'd be interested in ferrying @/numPassengers high paying tourists to and from the beach resort tiki huts at Nightingales's Cay which is on the southern shore of the South Island of the KSC Isles, also known as Valentina's Island.

	synopsis = Deliver @/numPassengers passengers to Nightingale's Cay.

	notes = You may use a boat or seaplane, but future versions of this contract will require a seaplane capable of landing back at KSC. These Tourists are actually temporary Crew that you can EVA with.

	completedMessage = Flight completed!\n\nNightingale is pleased to have @/numPassengers more visitors to his happenin' place, and KSC Island Tours thanks you for your service!

//Contract Limits
	maxCompletions = 0
   	maxSimultaneous = 1
	weight = 10.0

	autoAccept = false
	declinable = true
	cancellable = true
	
	minExpiry = 7.0
	maxExpiry = 7.0
	deadline = 0

//Contract Reward Modifiers
	prestige = Trivial
	targetBody = Kerbin

//Contract Rewards
  	advanceFunds = @/numPassengers * 2200.0
  	rewardFunds = 0.0
  	rewardReputation = 1.0
	rewardScience = 0.0

//Contract Penalties	
  	failureFunds = @/numPassengers * 3500.0
 	failureReputation = 5.0


//BEHAVIORS TO DO WHEN CREATING CONTRACT

	BEHAVIOUR
	{
		name = SpawnPassengers
		type = SpawnPassengers
		
		kerbal = @/kerbals
		
		kerbalType = Crew
		
	}
	
	BEHAVIOUR
	{
		name = SpawnKerbal
		type = SpawnKerbal

		KERBAL
		{
			name = Nightingale Kerman
			gender = Male
			owned = false
			addToRoster = false
			
			pqsCity = IslandAirfield
			pqsOffset = 11482.8888459748, 23195.0201781236, -671.327826027438
			alt = 20
			heading = 191
			
		}
		
	}

	BEHAVIOUR
	{
		name = SpawnCayDock
		type = SpawnVessel

		VESSEL
		{
			name = Cay Dock
			craftURL = ContractPacks/GAP/Assets/Dock.craft
			flagURL = ContractPacks/GAP/Assets/KSCIslandTours
			vesselType = Base
			owned = false
			
			pqsCity = IslandAirfield
			pqsOffset = 11486.1575391202, 23202.4235570873, -674.182826470496
			heading = 198

		}
		
	}

	BEHAVIOUR
	{
		name = SpawnFishNChips
		type = SpawnVessel

		VESSEL
		{
			name = FishNChips			
			craftURL = ContractPacks/GAP/Assets/TourBoat.craft
			flagURL = ContractPacks/GAP/Assets/KSCIslandTours
			vesselType = Ship
			owned = false
			
			pqsCity = IslandAirfield
			pqsOffset = 11475.6631548663, 23212.4327015801, -673.970972905692
			heading = 0
			pitch = 270
			
		}
		
	}
	
	BEHAVIOUR
	{
		name = SpawnTiki1
		type = SpawnVessel

		VESSEL
		{
			name = Tiki Hut 1
			craftURL = ContractPacks/GAP/Assets/TikiHut.craft
			flagURL = ContractPacks/GAP/Assets/KSCIslandTours
			vesselType = Base
			owned = false
			
			pqsCity = IslandAirfield
			pqsOffset = 11464.6071566473, 23179.2483194294, -658.541745985451
			heading = 200
			pitch = 270
			alt = 14 

		}
		
	}
	
	BEHAVIOUR
	{
		name = SpawnTiki2
		type = SpawnVessel
	
		VESSEL
		{
			name = Tiki Hut 2
			craftURL = ContractPacks/GAP/Assets/TikiHut.craft
			flagURL = ContractPacks/GAP/Assets/KSCIslandTours
			vesselType = Base
			owned = false
			
			pqsCity = IslandAirfield
			pqsOffset = 11478.2590820091, 23178.67620433, -661.335804493196
			heading = 200
			pitch = 275
			alt = 11.5
			
		}
		
	}
	
	BEHAVIOUR
	{
		name = SpawnTiki3
		type = SpawnVessel

		VESSEL
		{
			name = Tiki Hut 3
			craftURL = ContractPacks/GAP/Assets/TikiHut.craft
			flagURL = ContractPacks/GAP/Assets/KSCIslandTours
			vesselType = Base
			owned = false
			
			pqsCity = IslandAirfield
			pqsOffset = 11459.244745864, 23193.0548879867, -662.891364874842
			heading = 200
			pitch = 270
			alt = 11
			
		}
	
	}
	
	BEHAVIOUR
	{
        	name = WaypointGenerator
        	type = WaypointGenerator
		
		PQS_CITY
		{
			name = Valentina's Island
			icon = marker
			
			pqsCity = IslandAirfield
			pqsOffset = 10366.627166856, 23361.2467133673, 221.869934428483
			
		}
		
		PQS_CITY
		{
			name = Nightingale's Cay
			icon = marker
			
			pqsCity = IslandAirfield
			pqsOffset = 11483.1934275414, 23196.4335340857, -671.961082304042
			parameter = VisitWaypoint0
			
		}
	
	}

//Remove all SpawnVessels when done
	BEHAVIOUR
	{
		name = DestroyVessel
		type = DestroyVessel
		onState = CONTRACT_SUCCESS
		
		vessel = Cay Dock
		vessel = FishNChips
		vessel = Tiki Hut 1
		vessel = Tiki Hut 2
		vessel = Tiki Hut 3
		
	}


//PARAMETERS FOR CONTRACT COMPLETION

//Craft Requirements
	PARAMETER
	{
		name = Any
		type = Any
		title = Your craft must have an engineer or pilot
		hideChildren = true
		
		disableOnStateChange = false
		
		PARAMETER
		{
			name = HasCrew
			type = HasCrew
			
			trait = Pilot
			minCrew = 1
			
			hideChildren = true
			disableOnStateChange = false
			
		}
		
		PARAMETER
		{
			name = HasCrew
			type = HasCrew
			
			trait = Engineer
			minCrew = 1
			
			hideChildren = true
			disableOnStateChange = false
			
		}
		
	}
	
	PARAMETER
	{
		name = HasCrewCapacity
		type = HasCrewCapacity
		title = and have at least @/numPassengers passenger seats for
		
		minCapacity = @/numPassengers + 1
		
		disableOnStateChange = false
		
	}
	
//Passenger Manifest
	PARAMETER
	{
		name = HasPassengers
		type = HasPassengers
		title = Passenger: @/kerbals.ElementAt(0)		
		kerbal = @/kerbals.ElementAt(0)
		hideChildren = true
		
		REQUIREMENT
		{
			type = Expression
			expression = @/numPassengers >= 1
			
		}
		
	}
	
	PARAMETER
	{
		name = HasCrew
		type = HasCrew
		title = Passenger: @/kerbals.ElementAt(1)
		kerbal = @/kerbals.ElementAt(1)
		hideChildren = true
		
		REQUIREMENT
		{
			type = Expression
			expression = @/numPassengers >= 2
			
		}
		
	}
	
	PARAMETER
	{
		name = HasCrew
		type = HasCrew
		title = Passenger: @/kerbals.ElementAt(2)
		kerbal = @/kerbals.ElementAt(2)
		hideChildren = true
		
		REQUIREMENT
		{
			type = Expression
			expression = @/numPassengers >= 3
			
		}
		
	}
	
	PARAMETER
	{
		name = HasCrew
		type = HasCrew
		title = Passenger: @/kerbals.ElementAt(3)
		kerbal = @/kerbals.ElementAt(3)
		hideChildren = true
		
		REQUIREMENT
		{
			type = Expression
			expression = @/numPassengers >= 4
			
		}
		
	}
	
	PARAMETER
	{
		name = HasCrew
		type = HasCrew
		title = Passenger: @/kerbals.ElementAt(4)
		kerbal = @/kerbals.ElementAt(4)
		hideChildren = true
		
		REQUIREMENT
		{
			type = Expression
			expression = @/numPassengers >= 5
			
		}
		
	}
	
	PARAMETER
	{
		name = HasCrew
		type = HasCrew
		title = Passenger: @/kerbals.ElementAt(5)
		kerbal = @/kerbals.ElementAt(5)
		hideChildren = true
		
		REQUIREMENT
		{
			type = Expression
			expression = @/numPassengers >= 6
			
		}
		
	}

//Navigate to waypoint parameters
	PARAMETER
	{
		name = VisitWaypoint0
		type = VisitWaypoint
		index = 0
		distance = 2000
		title = Arrive at Valentina's Island
		
		hideChildren = true
		hideOnCompletion = true
		completeInSequence = true
		disableOnStateChange = true
		
	}

	PARAMETER
	{
		name = VisitWaypoint1
		type = VisitWaypoint
		index = 1
		distance = 50
		title = Dock at Nightingale's Cay
		
		hideChildren = true
		hideOnCompletion = true
		completeInSequence = true
		disableOnStateChange = true
		
	}
	
//Requires unloading of outbound passengers
PARAMETER
	{
		name = HasNotPassengers
		type = Not
		title = Unload all passengers
		
		disableOnStateChange = false

//Because Not switches all child param ANDs to ORs (such as HasPassengers or HasCrew), we must check each kerbal is a passenger with a separate HasPassenger or HasCrew.

		PARAMETER
		{
			name = HasCrew
			type = HasCrew
			
			kerbal = @/kerbals.ElementAt(0)

			REQUIREMENT
			{
				type = Expression
				expression = @/numPassengers >= 1
				
			}
			
		}
		
		PARAMETER
		{
			name = HasCrew
			type = HasCrew

			kerbal = @/kerbals.ElementAt(1)
			
			REQUIREMENT
			{
				type = Expression
				expression = @/numPassengers >= 2
				
			}

		}
		
		PARAMETER
		{
			name = HasCrew
			type = HasCrew

			kerbal = @/kerbals.ElementAt(2)
			
			REQUIREMENT
			{
				type = Expression
				expression = @/numPassengers >= 3
				
			}

		}
		
		PARAMETER
		{
			name = HasCrew
			type = HasCrew

			kerbal = @/kerbals.ElementAt(3)
			
			REQUIREMENT
			{
				type = Expression
				expression = @/numPassengers >= 4
				
			}

		}
		
		PARAMETER
		{
			name = HasCrew
			type = HasCrew

			kerbal = @/kerbals.ElementAt(4)
			
			REQUIREMENT
			{
				type = Expression
				expression = @/numPassengers >= 5
				
			}

		}
		
		PARAMETER
		{
			name = HasCrew
			type = HasCrew

			kerbal = @/kerbals.ElementAt(5)
			
			REQUIREMENT
			{
				type = Expression
				expression = @/numPassengers >= 6
				
			}

		}
		
	}
	
//Recovery Parameters - No vessel destroy, no Kerbal deaths	
	PARAMETER
	{
		name = All
		type = All
		title = Recover your craft at the dock
		hideChildren = true

		PARAMETER
		{
			name = VesselNotDestroyed
			type = VesselNotDestroyed
			
		}
		
		PARAMETER
		{
			name = KerbalDeaths
			type = KerbalDeaths
			title = and do not kill anyone in the process 
			countMax = 1
			
		}
		
			PARAMETER
		{
			name = RecoverVessel
			type = RecoverVessel
			
		}
		
	}

}
