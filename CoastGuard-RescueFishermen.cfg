//CoastGuard-RescueFishermen - KSC Coast Guard: S.O.S. Distress Call - (shipName)

CONTRACT_TYPE
{


//REQUIREMENTS FOR CONTRACT TO APPEAR

	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract

		contractType = CoastGuard-Certification
		minCount = 1
		
	}

	
//DATA NODES TO PROCESS FOR CONTRACT USE

//Coast Guard Team Data
	DATA
	{
		type = List<Kerbal>
		
		kerbalsCoastGuard = [ NewKerbal( Male , "Lt. Dan Kerman" , "Pilot") ]
		
	}

//Kerbals in Distress Data
	DATA
	{
		type = List<Kerbal>
		
		kerbalsInDistress = [ NewKerbal(), NewKerbal() ]
	
	}	

	DATA
	{
	
	type = string
	
		shipName = "S.S. " + RandomKerbalName(Random()).FirstWord()
	
	}
	
	DATA
	
	{
		type = List<string>
		
		distressReportData = [ "their engine has taken on water" , "they had an engine fire" , "their alternator is disabled", "their ship was hit by a rogue wave in the recent storm", "there was a fight over the last remaining snacks and in the scuffle the keys to the engine were lost overboard", "caught such a large fish that their boat capsized (the dispatcher doesn't quite believe this fish story)" ]

	}
	
	DATA
	{
		type = string
		
		distressReport = @/distressReportData.Random()
		
	}
	
	
//CONTRACT DESCRIPTION

	name = CoastGuard-RescueFishermen
	title = S.O.S. Distress Call - @/shipName
	group = KSC Coast Guard
	agent = KSC Coast Guard

	description = An S.O.S. was reported by the fishing vessel @/shipName somewhere in the waters between KSC and KSC Island. The captain reports @/distressReport, and they are adrift. Rescue the crew and return them to an authorized KSC landing zone for a safe recovery. Lt. Dan Kerman from the KSC Coast Guard will be on board to help with the rescue. You may use an airplane, helicopter, or VTOL aircraft.

	synopsis = KSC Coast Guard: Our motto is Always Ready - Kemper Keratus!

	notes = Rescue all fishing vessel crew members from the waters of the ocean and bring them back to KSC for recovery and snacks.
	
	completedMessage = Mission Completed! The crew of the @/shipName thank you for rescuing them from the waters off KSC. Your heroics have not gone unnoticed and your reputation has now grown a little bit more!

//Contract Limits
	maxCompletions = 0
	maxSimultaneous = 1
	weight = 10.0

	autoAccept = false
	declinable = true
	cancellable = true

	minExpiry = 1.0
	maxExpiry = 1.0
	deadline = 1

//Contract Reward Modifiers
	prestige = Significant
	targetBody = Kerbin
	
//Contract Rewards
  	advanceFunds = 5000.0
	rewardFunds = 5000.0
  	rewardReputation = 15.0
 	rewardScience = 1.0
	
//Contract Penalties
  	failureFunds = 10000.0
	failureReputation = 20.0
	

//BEHAVIOURS TO DO WHEN CREATING CONTRACT
	BEHAVIOUR
	{
		name = SpawnPassengers
		type = SpawnPassengers
		
		kerbal = @/kerbalsCoastGuard.ElementAt(0)
		kerbalType = Crew
		
	}

	BEHAVIOUR
	{
		name = SpawnKerbal
		type = SpawnKerbal

		KERBAL
		{
			kerbal = @/kerbalsInDistress.ElementAt(0)
			kerbalType = Unowned
			owned = false
			addToRoster = false

			pqsCity = KSC
			pqsOffset = 12867.0651104605, -18789.3871168656, -474.061093828
			alt = 0
			heading = 350
			
		}

		KERBAL
		{
			kerbal = @/kerbalsInDistress.ElementAt(1)
			kerbalType = Unowned
			owned = false
			addToRoster = false
			
			pqsCity = KSC
			pqsOffset = 12867.5539144455, -18790.0284529034, -474.759797401123
			alt = 0
			heading = 80
			
		}
		
	}
	
	BEHAVIOUR
	{
		name = SpawnVessel
		type = SpawnVessel
		deferVesselCreation = false

		VESSEL
		{
			name = @/shipName
			craftURL = ContractPacks/GAP/Assets/Speedboat.craft
			vesselType = Ship
			owned = True
			targetBody = Kerbin

			pqsCity = IslandAirfield
			pqsOffset = 15865.6687187416, 502.391554190035, -324.868682358054
			alt = -5
			heading = 133.5
			pitch = 90
			roll = 180
			
		}
		
	}
	
	BEHAVIOUR
	{
		name = WaypointGenerator
		type = WaypointGenerator
	   
		WAYPOINT       
		{
			name = S.O.S.         
			icon = marker
			
			latitude = -1.9000277169078
			longitude = 286.61659588561
			altitude = 20
			
			//PQS: IslandAirfield 15866.2010362021, 502.475233629535, -305.95269424668
			
		}
		
	}
	
//Remove all SpawnVessels when done
	BEHAVIOUR
	{
		name = DestroyVessel
		type = DestroyVessel
		
		onState = CONTRACT_SUCCESS
		vessel = @/shipName
		
	}

	
//PARAMETERS FOR CONTRACT COMPLETION

//Craft definition
	PARAMETER
	{
		name = VesselParameterGroup
		type = VesselParameterGroup
		title = Your craft must
		
		define = craft
		dissassociateVesselsOnContractCompletion = true

		PARAMETER
		{
			name = HasCrew
			type = HasCrew
			title = have a Kerbal in command
			
			minCrew = 1
		
			disableOnStateChange = false
			hideChildren = true

		}
		
		PARAMETER
		{
			name = HasCrewCapacity
			type = HasCrewCapacity
			title = have at least 2 passenger seats
			
			minCapacity = 3
			
			disableOnStateChange = false
			
		}
		
		disableOnStateChange = false

	}

//Passenger Manifest - Load Passengers
	PARAMETER
	{
		name = All
		type = All
		
		title = load your Coast Guard rescue officer
		
		PARAMETER
		{
			name = HasPassengers
			type = HasPassengers
			title = @kerbal.First()
	
			ITERATOR
			{
				type = Kerbal
				kerbal = @/kerbalsCoastGuard
				
			}
			
			hideChildren = true
			
		}

	}


//Contract Goals
	PARAMETER
	{
		name = VisitWaypoint
		type = VisitWaypoint
		title = navigate to S.O.S Waypoint
		
		index = 0
		distance = 500
		hideOnCompletion = true
		
		disableOnStateChange = true
		hideChildren = true
		
	}

	PARAMETER
	{
		name = HasCrew
		type = HasCrew
		title =  rescue crew of the @/shipName
		
		kerbal = @/kerbalsInDistress

		completeInSequence = true
		disableOnStateChange = false
	
	}

//Recovery Parameter - Landing
	PARAMETER
	{
		name = Any
		type = Any
		title = and then land back at KSC
		
		PARAMETER
		{
			name = Any
			type = Any
			title = on either

			PARAMETER
			{
				name = VesselParameterGroup
				type = VesselParameterGroup
				title = the KSC runway
				
				vessel = craft

			PARAMETER
				{
					name = ReachState
					type = ReachState
					
					targetBody = Kerbin
					biome = Runway
					situation = LANDED
					maxSpeed = 0.0

					disableOnStateChange = false
					hideChildren = true

				}

				hideChildren = true		

			}
			
			PARAMETER
			{
				name = VesselParameterGroup
				type = VesselParameterGroup
				title = the Vehicle Assembly Building helipad
				
				vessel = craft

			PARAMETER
				{
					name = ReachState
					type = ReachState
					
					targetBody = Kerbin
					biome = VAB Main Building
					situation = LANDED
					maxSpeed = 0.0

					disableOnStateChange = false
					hideChildren = true

				}

				hideChildren = true		

			}
			
			PARAMETER
			{
				name = VesselParameterGroup
				type = VesselParameterGroup
				title = or the Administration Building helipad
				
				vessel = craft

				PARAMETER
				{
					name = ReachState
					type = ReachState

					targetBody = Kerbin
					biome = Administration	
					situation = LANDED
					maxSpeed = 0.0
					
					disableOnStateChange = false
					hideChildren = true
					
				}

				hideChildren = true		

			}
		
		}

	}

//Recovery Parameter - Craft & Kerbal Safety Check
	PARAMETER
	{
		name = All
		type = All
		title = safely
		
		completeInSequence = true
		disableOnStateChange = true
		
		PARAMETER
		{
			name = VesselNotDestroyed
			type = VesselNotDestroyed
			title = without destroying your craft
			
			vessel = craft

		}
		
		PARAMETER
		{
			name = KerbalDeaths
			type = KerbalDeaths
			title = or killing anyone
			
			countMax = 1

		}
		
	}
	
//Recovery Parameter - Recover Kerbals
	PARAMETER
	{
		name = All
		type = All
		title = and recover
		
		PARAMETER
		{
			name = RecoverKerbal
			type = RecoverKerbal
			title = @kerbal.First()
	
			ITERATOR
			{
				type = Kerbal
				kerbal = @/kerbalsCoastGuard
				
			}
			
			hideChildren = true
			
		}
		
		PARAMETER
		{
			name = RecoverKerbal
			type = RecoverKerbal
			title = @kerbal.First()
	
			ITERATOR
			{
				type = Kerbal
				kerbal = @/kerbalsInDistress
				
			}
			
			hideChildren = true
			
		}
		
	}
	
}